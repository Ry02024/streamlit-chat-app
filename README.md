はい、承知いたしました。以下に、このアプリケーションのREADME.mdとして記載すべき内容を、簡潔かつ体系的にまとめます。

---

# Secure Streamlit Chat App

## 概要

このアプリケーションは、Googleアカウント認証を備えた、リアルタイムな1対1チャットWebアプリケーションです。ユーザーは安全に特定の相手とメッセージを送受信できます。Streamlitフレームワークを利用し、Google Cloud Platform (GCP) 上でサーバーレス環境 (Cloud Run) で動作するように設計されています。

## 主な機能

*   **ユーザー認証:** Googleアカウントを使用した安全なログインおよびログアウト機能。
*   **1対1チャット:** 認証されたユーザー間で、指定した相手と個別のチャットルームで会話できます。
*   **メッセージ送受信:** リアルタイムに近い形でのメッセージの送信と表示。
*   **チャット履歴:** 会話内容は永続化され、チャットルームごとに履歴が表示されます。
*   **相手選択:** チャットを行いたい相手を選択する基本的なインターフェース。

## 技術スタック

*   **アプリケーションフレームワーク:** Streamlit (Python)
*   **認証:** Firebase Authentication (Google Identity Provider)
*   **データベース:** Google Cloud Firestore (ネイティブモード)
*   **コンテナ化:** Docker
*   **実行環境:** Google Cloud Run (フルマネージド)
*   **(オプション) CI/CD:** GitHub Actions
*   **(オプション) クラウド連携:** GCP Workload Identity Federation

## セキュリティ機能 (非機能要件)

*   **認証:** 未認証ユーザーはチャット機能へのアクセスが制限されます。全ての操作はFirebase Authenticationによる認証が前提となります。
*   **認可 (データアクセス制御):** Firestoreセキュリティルールにより、各ユーザーは自身が送信者または受信者として関与しているチャットメッセージのみ読み書き可能です。他者のプライベートな会話へのアクセスはデータベースレベルでブロックされます。
*   **セキュアなデプロイ:** Cloud Runの実行サービスアカウントを利用することで、長期的な認証キーの管理リスクを低減します (推奨構成)。

## 実行環境 (非機能要件)

*   **スケーラビリティ:** Cloud Run上で動作するため、アクセス負荷に応じて自動的にスケールイン・スケールアウトします。
*   **可用性:** GCPのマネージドサービスを利用することで、インフラ管理の手間を削減し、高い可用性を期待できます。
*   **サーバーレス:** サーバーのプロビジョニングや管理が不要です。

## セットアップとデプロイ (概要)

1.  **前提条件:** GCPアカウント、Firebaseプロジェクト、Python、Docker、gcloud CLIが必要です。
2.  **設定:** Firebase Authentication (Google Provider) の有効化、Firestoreデータベースの作成、サービスアカウントキーの取得（ローカル開発用）、Cloud Run用サービスアカウントの作成と権限付与が必要です。
3.  **ローカル実行:** 依存関係をインストールし、Streamlit Secretsに認証情報を設定後、`streamlit run app.py` で起動します。
4.  **Cloud Runデプロイ:** `Dockerfile` を用いてコンテナイメージをビルドし、Artifact Registryにプッシュ後、`gcloud run deploy` コマンドでCloud Runサービスとしてデプロイします。Firebase Authenticationの承認済みドメイン設定も更新が必要です。

---
